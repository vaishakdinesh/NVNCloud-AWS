{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "csye6225 cloudformation application stack",

  "Parameters": {

  		"DBName": {
  			"Description": "Database Name",
  			"Type": "String"
  		},
  		"DBUser": {
  			"Description": "Database User",
  			"Type": "String"
  		},
  		"DBPassword": {
  			"Description": "Database Password",
  			"Type": "String"
  		},


  		"bucketName": {
  			"Description": "Bucket name",
  			"Type": "String"
  		}
    },


  "Resources" : {
    "myDynamoDBTable": {
  		      "Type": "AWS::DynamoDB::Table",
  		      "Properties": {
  			"AttributeDefinitions": [
  			  {
  			    "AttributeName": "Id",
  			    "AttributeType": "S"
  			  }
  			],
  			"KeySchema": [
  			  {
  			    "AttributeName": "Id",
  			    "KeyType": "HASH"
  			  }
  			],
  			"ProvisionedThroughput": {
  			  "ReadCapacityUnits": "5",
  			  "WriteCapacityUnits": "5"
  			},
  			"TableName": "csye6225"
  		      }
		    },
    "myS3Bucket": {
            "Type": "AWS::S3::Bucket",
            "Properties": {

              "BucketName": {
                "Ref": "bucketName"
              }
            }
        },

        "MyDB": {
            "Type": "AWS::RDS::DBInstance",
            "Properties": {
              "Engine": "MySQL",
              "AllocatedStorage": "100",
              "EngineVersion": "5.6.37",
              "DBInstanceClass": "db.t2.medium",
              "MultiAZ": "false",
              "DBInstanceIdentifier": "csye6225-spring2018",
              "MasterUsername": {
                "Ref": "DBUser"
              },
              "MasterUserPassword": {
                "Ref": "DBPassword"
              },
              "PubliclyAccessible": "false",
              "DBName": {
                "Ref": "DBName"
              },

              "VPCSecurityGroups": [{"Fn::ImportValue" : "RDSGroupName"}],
              "DBSubnetGroupName": {"Fn::ImportValue" : "DBSubnetGroupName"}
            },
            "DeletionPolicy": "Snapshot"
          },

    "EC2Instance": {
    			"Type": "AWS::EC2::Instance",
    			"Properties": {
    				"ImageId": "ami-66506c1c",
    				"InstanceType": "t2.micro",
            "BlockDeviceMappings": [
                 {
                     "DeviceName" :  "/dev/sda1",
                     "Ebs" : {
                        "VolumeType" : "gp2",
                        "VolumeSize" : 16,
                        "DeleteOnTermination" : false
                    }
                 }
             ]
          }
          }
}
}
